<!DOCTYPE html>
<html>
<head>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
  <title>„Éõ„Éº„É†„Éö„Éº„Ç∏</title>
</head>
<body>

<header>
  <form method="GET" action="/post" style="display:inline;">
    <input type="submit" value="ÊäïÁ®ø„Åô„Çã">
  </form>
  <form method="GET" action="/mypage" style="display:inline;">
    <input type="submit" value="„Éû„Ç§„Éö„Éº„Ç∏">
  </form>
</header>

<main>
  <h1>„É°„ÉÉ„Çª„Éº„Ç∏‰∏ÄË¶ß</h1>
  <ul>
    {% for post in posts %}
      <li>
        <strong>{{ post[0] }}</strong>: {{ post[1] }}
        <form method="POST" action="/like" style="display:inline;">
          <input type="hidden" name="post_id" value="{{ post[2] }}">
          <button type="submit" class="like-button" aria-label="„ÅÑ„ÅÑ„Å≠">
            {% if post[2] in like_post_ids %}
              <span style="color:red;">‚ù§Ô∏è</span>
            {% else %}
              <span style="color:gray;">ü§ç</span>
            {% endif %}
          </button>
        </form>
        <button type="button" onclick="toggleCommentForm('{{ post[2]|safe }}')" aria-label="„Ç≥„É°„É≥„Éà„ÇíËøΩÂä†">üí¨ „Ç≥„É°„É≥„Éà</button>

        <div id="comment-form-{{ post[2] }}" class="comment-form">
          <form method="POST" action="/comment/{{ post[2] }}">
            <textarea name="content" rows="2" cols="50" placeholder="„Ç≥„É°„É≥„Éà„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ"></textarea>
            <br>
            <button type="submit">ÈÄÅ‰ø°</button>
          </form>
        </div>

    
        <div class="comments">
          <h3>„Ç≥„É°„É≥„Éà‰∏ÄË¶ß:</h3>
          <ul>
            {% for comment in comments_by_post[post[2]] %}
              <li><strong>{{ comment.username }}</strong>: {{ comment.content }}</li>
            {% endfor %}
          </ul>
        </div>
      </li>
    {% endfor %}
  </ul>
</main>

<script>
  function toggleCommentForm(postId) {
    const form = document.getElementById(`comment-form-${postId}`);
    if (form.style.display === "none" || form.style.display === "") {
      form.style.display = "block";
    } else {
      form.style.display = "none";
    }
  }
</script>

</body>
</html>